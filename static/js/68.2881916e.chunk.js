(this["webpackJsonpvuexy-react-admin-dashboard"]=this["webpackJsonpvuexy-react-admin-dashboard"]||[]).push([[68],{1465:function(e,t,a){"use strict";a.r(t);a(143);var c=a(1),s=a(4),n=a(14),r=a(8),i=a(22),l=a(2),d=a(13),o=a(139),u=a(7),j=a.n(u),b=a(5),f=a(544),O=a.n(f),m=a(830),v=(a(555),a(535)),x=a(532),h=a(538),p=a(539),g=a(145),k=a(96),N=a(525),I=a(526),y=(a(536),a(534),a(529),a(533),a(10)),w=a(140),S=a(16),C=Object(y.b)(),T=Object(y.d)(),D=function(){var e,t,a,u,f,y,D,z=Object(l.useState)(!1),B=Object(i.a)(z,2),F=B[0],P=B[1],q=function(){return Object(S.jsx)(l.Fragment,{children:Object(S.jsx)(I.a,{})})},E={multiValue:function(e,t){return Object(r.a)(t),Object(n.a)(Object(n.a)({},e),{},{backgroundColor:"#7367f0"})}},V=Object(l.useRef)(null),A=Object(d.f)(),R=Object(l.useState)(!1),L=(Object(i.a)(R,1)[0],Object(l.useState)("")),Y=Object(i.a)(L,2),_=Y[0],M=Y[1],U=Object(d.g)().id,J=h.d().shape({id:h.f().default(U),updatedBy:h.f().default(T),clientId:h.f().required("Please select a Client"),serviceId:h.f().required("Please select a Service"),assignee:h.a().min(1,"Please select Assignee"),reviewer:h.a(),clientAccessFlag:h.b().default(!1),organizationId:h.f().default(C),taskStatus:h.c().default(1),invoiceId:h.f().default(0),startDate:h.f().required("Please Select Start Date"),endDate:h.f().required("Please Select End Date"),priority:h.f().required("Please select a Priority"),invoiceFlag:h.b().default(!1)}),K=Object(w.c)((function(e){return e.task})),H=Object(x.f)({resolver:Object(p.a)(J),defaultValues:J.cast()}),G=H.handleSubmit,Q=H.formState.errors,W=H.control,X=H.reset,Z=H.setValue,$=[{id:1,name:"Low"},{id:2,name:"Medium"},{id:3,name:"High"}],ee=Object(l.useState)([]),te=Object(i.a)(ee,2),ae=te[0],ce=te[1],se=Object(l.useState)([]),ne=Object(i.a)(se,2),re=ne[0],ie=ne[1],le=Object(l.useState)(),de=Object(i.a)(le,2),oe=de[0],ue=de[1],je=Object(l.useState)(),be=Object(i.a)(je,2),fe=be[0],Oe=be[1],me=Object(l.useState)(""),ve=Object(i.a)(me,2),xe=ve[0],he=ve[1],pe=Object(l.useState)({}),ge=Object(i.a)(pe,2),ke=ge[0],Ne=ge[1],Ie=Object(l.useState)(!1),ye=Object(i.a)(Ie,2),we=ye[0],Se=ye[1],Ce=Object(w.b)(),Te=Object(l.useState)([]),De=Object(i.a)(Te,2),ze=De[0],Be=De[1],Fe=Object(l.useState)([]),Pe=Object(i.a)(Fe,2),qe=Pe[0],Ee=Pe[1],Ve=Object(l.useState)([]),Ae=Object(i.a)(Ve,2),Re=Ae[0],Le=Ae[1],Ye=Object(l.useState)(!1),_e=Object(i.a)(Ye,2),Me=_e[0],Ue=_e[1],Je=Object(l.useState)([]),Ke=Object(i.a)(Je,2),He=Ke[0],Ge=Ke[1];Object(l.useEffect)(Object(s.a)(Object(c.a)().mark((function e(){var t,a,s,r,i,l;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===K.taskId){e.next=23;break}return t=He.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{taskId:K.taskId})})),a=[],s=He.map((function(e){return e.userId})),K.selectedTask.assignee.forEach((function(e){-1===s.indexOf(e.id)&&a.push(e.id)})),K.selectedTask.reviewer.forEach((function(e){-1===s.indexOf(e.id)&&a.push(e.id)})),e.next=8,Ce(Object(g.c)({rows:t,deletedUser:a,taskId:K.taskId}));case 8:if(K.selectedTask.serviceid===W._formValues.serviceId){e.next=12;break}return r={taskId:K.taskId,serviceId:W._formValues.serviceId,organizationId:C,createdBy:T},e.next=12,Ce(Object(g.e)(r));case 12:if(""===xe){e.next=21;break}if(i={comment:xe,taskId:K.taskId,createdBy:T,updatedBy:T,organizationId:C,attachmentIds:[],id:void 0===ke?"":ke.id,isDefault:!0},we){e.next=19;break}return e.next=17,Ce(Object(g.a)(i));case 17:e.next=21;break;case 19:return e.next=21,Ce(Object(g.o)(i));case 21:l=K.taskId,A("/task/view/".concat(l));case 23:case"end":return e.stop()}}),e)}))),[K.taskId]);var Qe=function(e,t){return{organizationId:C,userId:e,type:t,createdBy:T}},We=function(){var e=Object(s.a)(Object(c.a)().mark((function e(t){var a;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),a=[],t.assignee.forEach((function(e){a.push(Qe(e,1))})),void 0!==t.reviewer&&t.reviewer.forEach((function(e){a.push(Qe(e,2))})),Ge(a),delete t.assignee,delete t.reviewer,e.next=9,Ce(Object(g.s)(t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xe=function(){var e=Object(s.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.a.post("/organizationusers/dropdown",{status:1}).then((function(e){var t=e.data;ie(t.organizationusers),ce(t.organizationusers),Le(t.organizationusers)})).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){b.a.post("/clients/dropdown",{status:1}).then((function(e){var t=e.data;Be(t.clients)})),Xe(),b.a.post("/services/dropdown",{status:1}).then((function(e){var t=e.data;Ee(t.services)}))}),[]);var Ze=function(e){ue(e);var t,a=Array.isArray(e)?e.map((function(e){return e.id})):[];t=a.length>0?Re.filter((function(e){var t=e.id;return!a.some((function(e){return e===t}))})):Re,ie(t),Z("assignee",a)},$e=function(e){Oe(e);var t,a=Array.isArray(e)?e.map((function(e){return e.id})):[];t=a.length>0?Re.filter((function(e){var t=e.id;return!a.some((function(e){return e===t}))})):Re,ce(t),Z("reviewer",a)};Object(l.useEffect)(Object(s.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==K.selectedTask&&(X({updatedBy:T,clientId:K.selectedTask.clientid,serviceId:K.selectedTask.serviceid,clientAccessFlag:!1,organizationId:C,taskStatus:K.selectedTask.taskstatus,invoiceId:K.selectedTask.invoiceid||0,startDate:13===K.selectedTask.startdate.length?String(K.selectedTask.startdate/1e3):K.selectedTask.startdate,endDate:13===K.selectedTask.enddate.length?String(K.selectedTask.enddate/1e3):K.selectedTask.enddate,priority:parseInt(K.selectedTask.priority),invoiceFlag:K.selectedTask.invoiceflag}),Ue(K.selectedTask.invoiceflag),Ze(K.selectedTask.assignee),$e(K.selectedTask.reviewer));case 1:case"end":return e.stop()}}),e)}))),[K.selectedTask]),Object(l.useEffect)(Object(s.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===U){e.next=4;break}return e.next=3,Ce(Object(g.l)(U));case 3:b.a.post("/taskconversations/description",{taskId:U}).then((function(e){Ne(e.data.taskconversation),he(void 0===e.data.taskconversation?"":e.data.taskconversation.comment),void 0!==e.data.taskconversation&&Se(!0)})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)}))),[U]);return Object(S.jsx)(N.a,{blocking:F,loader:Object(S.jsx)(q,{}),children:Object(S.jsxs)("form",{onSubmit:G(We),children:[Object(S.jsxs)(k.l,{className:"invoice-preview-card",children:[Object.keys(Q).map((function(e,t){var a;return Object(S.jsxs)(k.I,{children:[" ",null===(a=Q[e])||void 0===a?void 0:a.message]},t)})),Object(S.jsx)(k.p,{children:"Edit Task"}),Object(S.jsx)(k.m,{className:"pb-2 px-2",children:Object(S.jsxs)(k.ib,{children:[Object(S.jsxs)("div",{className:"col-lg-6 col-sm-12",children:[Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label required",for:"clientId",children:"Client"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{control:W,name:"clientId",id:"clientId",render:function(e){var t=e.field,a=e.ref;return Object(S.jsx)(v.a,Object(n.a)(Object(n.a)(Object(n.a)({},t),{},{inputRef:a,className:j()("react-select",{"is-invalid":Q.clientId})},t),{},{classNamePrefix:"select",options:ze,value:ze.find((function(e){return e.id===t.value})),onChange:function(e){t.onChange(e.id),getClientData(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),Q.clientId&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(e=Q.clientId)||void 0===e?void 0:e.message})]})]}),Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label required",for:"serviceId",children:"Service"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{control:W,name:"serviceId",id:"serviceId",render:function(e){var t=e.field,a=e.ref;return Object(S.jsx)(v.a,Object(n.a)(Object(n.a)(Object(n.a)({},t),{},{inputRef:a,className:j()("react-select",{"is-invalid":Q.serviceId})},t),{},{classNamePrefix:"select",options:qe,value:qe.find((function(e){return e.id===t.value})),onChange:function(e){return t.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),Q.serviceId&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(t=Q.serviceId)||void 0===t?void 0:t.message})]})]}),Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label",for:"description",children:"Description"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{id:"description",name:"description",control:W,render:function(e){var t=e.field;return Object(S.jsx)(k.K,Object(n.a)(Object(n.a)({type:"textarea",invalid:Q.description&&!0,onInput:function(e){he(e.target.value)}},t),{},{defaultValue:xe.replace(/(\\n)/g,"\n")}))}}),Q.description&&Object(S.jsx)(k.I,{children:Q.description.message})]})]}),Object(S.jsx)(k.ib,{className:"my-2",children:Object(S.jsx)(k.B,{children:Object(S.jsxs)("div",{className:"d-lg-flex",children:[Object(S.jsx)("input",{type:"file",className:"hidden",multiple:!0,onChange:function(e){console.log(e.target.files)},ref:V}),Object(S.jsxs)(k.i,{type:"button",outline:!0,color:"primary",onClick:function(){return V.current.click()},children:[Object(S.jsx)(m.a,{size:14,className:"me-25"})," Add Attachment"]})]})})})]}),Object(S.jsxs)("div",{className:"col-lg-6 col-sm-12",children:[Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label required",for:"assignee",children:"Assignee"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{control:W,name:"assignee",id:"assignee",render:function(e){var t=e.field,a=e.ref;return Object(S.jsx)(v.a,Object(n.a)(Object(n.a)({inputRef:a,className:j()("react-select",{"is-invalid":Q.assignee})},t),{},{classNamePrefix:"select",options:ae,isMulti:!0,value:oe,onChange:Ze,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:E}))}}),Q.assignee&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(a=Q.assignee)||void 0===a?void 0:a.message})]})]}),Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label",for:"reviewer",children:"Reviewer"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{control:W,name:"reviewer",id:"reviewer",render:function(e){var t=e.field,a=e.ref;return Object(S.jsx)(v.a,Object(n.a)(Object(n.a)({inputRef:a,className:j()("react-select",{"is-invalid":Q.reviewer})},t),{},{classNamePrefix:"select",options:re,isMulti:!0,value:fe,onChange:$e,getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},styles:E}))}}),Q.reviewer&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(u=Q.reviewer)||void 0===u?void 0:u.message})]})]}),Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label required",for:"startDate",children:"Start Date"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{value:_,name:"startDate",control:W,rules:{required:!0},options:{dateFormat:"d-m-Y"},render:function(e){var t=e.field;return Object(S.jsx)(O.a,{value:t.value,onChange:function(e,a){t.onChange(a)},options:{altInput:!0,altFormat:"F j, Y",dateFormat:"U"},className:j()("due-date-picker",{"flatpickr-input is-invalid":Q.startDate})})}}),Q.startDate&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(f=Q.startDate)||void 0===f?void 0:f.message})]})]}),Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label required",for:"endDate",children:"End Date"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{value:_,onChange:function(e){return M(e)},name:"endDate",control:W,rules:{required:!0},options:{dateFormat:"d-m-Y"},render:function(e){var t=e.field;return Object(S.jsx)(O.a,{value:t.value,onChange:function(e,a){t.onChange(a)},options:{altInput:!0,altFormat:"F j, Y",dateFormat:"U"},className:j()("due-date-picker",{"flatpickr-input is-invalid":Q.endDate})})}}),Q.endDate&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(y=Q.endDate)||void 0===y?void 0:y.message})]})]}),Object(S.jsxs)(k.ib,{className:"mb-1",children:[Object(S.jsx)(k.N,{sm:"3",size:"lg",className:"form-label required",for:"priority",children:"Priority"}),Object(S.jsxs)(k.B,{sm:"9",children:[Object(S.jsx)(x.a,{control:W,name:"priority",id:"priority",render:function(e){var t=e.field,a=e.ref;return Object(S.jsx)(v.a,Object(n.a)(Object(n.a)(Object(n.a)({},t),{},{inputRef:a,className:j()("react-select",{"is-invalid":Q.priority})},t),{},{classNamePrefix:"select",options:$,value:$.find((function(e){return e.id===t.value})),onChange:function(e){return t.onChange(e.id)},getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id}}))}}),Q.priority&&Object(S.jsx)(k.I,{className:"text-danger",children:null===(D=Q.priority)||void 0===D?void 0:D.message})]})]})]})]})}),Object(S.jsx)("hr",{className:"invoice-spacing"}),Object(S.jsx)(k.ib,{className:"px-1 pb-2",children:Object(S.jsxs)("div",{className:"form-check form-check-primary mx-2",children:[Object(S.jsx)(x.a,{control:W,name:"invoiceFlag",rules:{required:!0},render:function(e){var t=e.field;return Object(S.jsx)(k.K,Object(n.a)(Object(n.a)({className:"form-check-input",type:"checkbox",id:"invoice_flag",value:t.value,checked:Me},t),{},{onChange:function(e){t.onChange(e),Ue(!Me)}}))}}),Object(S.jsx)(k.N,{className:"form-check-label",for:"invoice_flag",children:"Create Proposal for this Task"})]})})]}),Object(S.jsx)(k.l,{children:Object(S.jsx)(k.m,{children:Object(S.jsxs)("div",{className:"modal-footer border-0",children:[Object(S.jsx)(k.i,{className:"add-new-user",outline:!0,color:"warning",tag:o.b,to:"/task/view/".concat(U),children:"Cancel"}),Object(S.jsx)(k.i,{color:"primary",type:"submit",children:"Save"})]})})})]})})};t.default=function(){return Object(S.jsx)("div",{className:"invoice-add-wrapper",children:Object(S.jsx)(k.ib,{className:"invoice-add",children:Object(S.jsx)(k.B,{xl:12,md:12,sm:12,children:Object(S.jsx)(D,{})})})})}},525:function(e,t,a){"use strict";var c=a(14),s=a(34),n=a(2),r=a(7),i=a.n(r),l=a(96),d=(a(528),a(16)),o=function(e){var t,a=e.children,r=e.blocking,l=e.loader,o=e.className,u=e.tag,j=e.overlayColor,b=u;return Object(d.jsxs)(b,{className:i()("ui-loader",(t={},Object(s.a)(t,o,o),Object(s.a)(t,"show",r),t)),children:[a,r?Object(d.jsxs)(n.Fragment,{children:[Object(d.jsx)("div",Object(c.a)({className:"overlay"},r&&j?{style:{backgroundColor:j}}:{})),Object(d.jsx)("div",{className:"loader",children:l})]}):null]})};t.a=o,o.defaultProps={tag:"div",blocking:!1,loader:Object(d.jsx)(l.jb,{color:"primary"})}},526:function(e,t,a){"use strict";var c=a(16);t.a=function(){return Object(c.jsx)("div",{className:"fallback-spinner",children:Object(c.jsxs)("div",{className:"loading",children:[Object(c.jsx)("div",{className:"effect-1 effects"}),Object(c.jsx)("div",{className:"effect-2 effects"}),Object(c.jsx)("div",{className:"effect-3 effects"})]})})}},528:function(e,t,a){},529:function(e,t,a){},533:function(e,t,a){},536:function(e,t,a){}}]);
//# sourceMappingURL=68.2881916e.chunk.js.map